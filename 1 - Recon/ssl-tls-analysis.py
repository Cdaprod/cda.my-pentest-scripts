import ssl
import socket
from OpenSSL import crypto

target = 'example.com'
port = 443

def ssl_certificate_analysis(target, port):
    cert_raw = ssl.get_server_certificate((target, port))
    cert = crypto.load_certificate(crypto.FILETYPE_PEM, cert_raw)
    subject = dict(cert.get_subject().get_components())
    issuer = dict(cert.get_issuer().get_components())
    not_before = cert.get_notBefore().decode('utf-8')
    not_after = cert.get_notAfter().decode('utf-8')
    serial_number = cert.get_serial_number()

    print(f"Subject: {subject}")
    print(f"Issuer: {issuer}")
    print(f"Not Before: {not_before}")
    print(f"Not After: {not_after}")
    print(f"Serial Number: {serial_number}")

ssl_certificate_analysis(target, port)
